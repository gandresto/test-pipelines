# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- new-pipeline

pool:
  vmImage: windows-latest

steps:
- task: AzureCLI@2
  inputs:
    azureSubscription: 'Azure for Students (e209c568-0f60-4c6d-ae25-7f3a24b518db)'
    scriptType: 'ps'
    scriptLocation: 'inlineScript'
    inlineScript: 'az ad app create --display-name "chbot-inte2-pprd" --password "~iInM7-5S~t~RKo29Yz6d~i6fyOq3z3PEX" --available-to-other-tenants'
- task: AzureResourceManagerTemplateDeployment@3
  inputs:
    deploymentScope: 'Resource Group'
    azureResourceManagerConnection: 'Azure for Students(e209c568-0f60-4c6d-ae25-7f3a24b518db)'
    subscriptionId: 'e209c568-0f60-4c6d-ae25-7f3a24b518db'
    action: 'Create Or Update Resource Group'
    resourceGroupName: 'chbot-intevolution-test'
    location: 'West US'
    templateLocation: 'Linked artifact'
    csmFile: 'template.json'
    csmParametersFile: 'parameters.json'
    deploymentMode: 'Incremental'